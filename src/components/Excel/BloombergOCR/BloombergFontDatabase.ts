// Bloomberg Terminal Pixel Font Database
// Bloomberg uses monospace font approximately 7x11 or 8x12 pixels

// Character patterns - each character is represented as a 2D binary matrix
// 1 = foreground (text), 0 = background
export const BLOOMBERG_CHAR_PATTERNS: Record<string, number[][]> = {
  // Uppercase letters (8x12 approximate patterns)
  'A': [
    [0,0,1,1,1,0,0,0],
    [0,1,0,0,0,1,0,0],
    [1,0,0,0,0,0,1,0],
    [1,0,0,0,0,0,1,0],
    [1,1,1,1,1,1,1,0],
    [1,0,0,0,0,0,1,0],
    [1,0,0,0,0,0,1,0],
    [1,0,0,0,0,0,1,0],
  ],
  'B': [
    [1,1,1,1,1,0,0,0],
    [1,0,0,0,0,1,0,0],
    [1,0,0,0,0,1,0,0],
    [1,1,1,1,1,0,0,0],
    [1,0,0,0,0,1,0,0],
    [1,0,0,0,0,1,0,0],
    [1,0,0,0,0,1,0,0],
    [1,1,1,1,1,0,0,0],
  ],
  'C': [
    [0,1,1,1,1,1,0,0],
    [1,0,0,0,0,0,1,0],
    [1,0,0,0,0,0,0,0],
    [1,0,0,0,0,0,0,0],
    [1,0,0,0,0,0,0,0],
    [1,0,0,0,0,0,0,0],
    [1,0,0,0,0,0,1,0],
    [0,1,1,1,1,1,0,0],
  ],
  'D': [
    [1,1,1,1,0,0,0,0],
    [1,0,0,0,1,0,0,0],
    [1,0,0,0,0,1,0,0],
    [1,0,0,0,0,1,0,0],
    [1,0,0,0,0,1,0,0],
    [1,0,0,0,0,1,0,0],
    [1,0,0,0,1,0,0,0],
    [1,1,1,1,0,0,0,0],
  ],
  'E': [
    [1,1,1,1,1,1,0,0],
    [1,0,0,0,0,0,0,0],
    [1,0,0,0,0,0,0,0],
    [1,1,1,1,1,0,0,0],
    [1,0,0,0,0,0,0,0],
    [1,0,0,0,0,0,0,0],
    [1,0,0,0,0,0,0,0],
    [1,1,1,1,1,1,0,0],
  ],
  'F': [
    [1,1,1,1,1,1,0,0],
    [1,0,0,0,0,0,0,0],
    [1,0,0,0,0,0,0,0],
    [1,1,1,1,1,0,0,0],
    [1,0,0,0,0,0,0,0],
    [1,0,0,0,0,0,0,0],
    [1,0,0,0,0,0,0,0],
    [1,0,0,0,0,0,0,0],
  ],
  'G': [
    [0,1,1,1,1,1,0,0],
    [1,0,0,0,0,0,1,0],
    [1,0,0,0,0,0,0,0],
    [1,0,0,0,0,0,0,0],
    [1,0,0,1,1,1,1,0],
    [1,0,0,0,0,0,1,0],
    [1,0,0,0,0,0,1,0],
    [0,1,1,1,1,1,0,0],
  ],
  'H': [
    [1,0,0,0,0,0,1,0],
    [1,0,0,0,0,0,1,0],
    [1,0,0,0,0,0,1,0],
    [1,1,1,1,1,1,1,0],
    [1,0,0,0,0,0,1,0],
    [1,0,0,0,0,0,1,0],
    [1,0,0,0,0,0,1,0],
    [1,0,0,0,0,0,1,0],
  ],
  'I': [
    [1,1,1,1,1,0,0,0],
    [0,0,1,0,0,0,0,0],
    [0,0,1,0,0,0,0,0],
    [0,0,1,0,0,0,0,0],
    [0,0,1,0,0,0,0,0],
    [0,0,1,0,0,0,0,0],
    [0,0,1,0,0,0,0,0],
    [1,1,1,1,1,0,0,0],
  ],
  'J': [
    [0,0,0,0,0,1,0,0],
    [0,0,0,0,0,1,0,0],
    [0,0,0,0,0,1,0,0],
    [0,0,0,0,0,1,0,0],
    [0,0,0,0,0,1,0,0],
    [1,0,0,0,0,1,0,0],
    [1,0,0,0,0,1,0,0],
    [0,1,1,1,1,0,0,0],
  ],
  'K': [
    [1,0,0,0,0,1,0,0],
    [1,0,0,0,1,0,0,0],
    [1,0,0,1,0,0,0,0],
    [1,1,1,0,0,0,0,0],
    [1,0,0,1,0,0,0,0],
    [1,0,0,0,1,0,0,0],
    [1,0,0,0,0,1,0,0],
    [1,0,0,0,0,0,1,0],
  ],
  'L': [
    [1,0,0,0,0,0,0,0],
    [1,0,0,0,0,0,0,0],
    [1,0,0,0,0,0,0,0],
    [1,0,0,0,0,0,0,0],
    [1,0,0,0,0,0,0,0],
    [1,0,0,0,0,0,0,0],
    [1,0,0,0,0,0,0,0],
    [1,1,1,1,1,1,0,0],
  ],
  'M': [
    [1,0,0,0,0,0,1,0],
    [1,1,0,0,0,1,1,0],
    [1,0,1,0,1,0,1,0],
    [1,0,0,1,0,0,1,0],
    [1,0,0,0,0,0,1,0],
    [1,0,0,0,0,0,1,0],
    [1,0,0,0,0,0,1,0],
    [1,0,0,0,0,0,1,0],
  ],
  'N': [
    [1,0,0,0,0,0,1,0],
    [1,1,0,0,0,0,1,0],
    [1,0,1,0,0,0,1,0],
    [1,0,0,1,0,0,1,0],
    [1,0,0,0,1,0,1,0],
    [1,0,0,0,0,1,1,0],
    [1,0,0,0,0,0,1,0],
    [1,0,0,0,0,0,1,0],
  ],
  'O': [
    [0,1,1,1,1,0,0,0],
    [1,0,0,0,0,1,0,0],
    [1,0,0,0,0,1,0,0],
    [1,0,0,0,0,1,0,0],
    [1,0,0,0,0,1,0,0],
    [1,0,0,0,0,1,0,0],
    [1,0,0,0,0,1,0,0],
    [0,1,1,1,1,0,0,0],
  ],
  'P': [
    [1,1,1,1,1,0,0,0],
    [1,0,0,0,0,1,0,0],
    [1,0,0,0,0,1,0,0],
    [1,1,1,1,1,0,0,0],
    [1,0,0,0,0,0,0,0],
    [1,0,0,0,0,0,0,0],
    [1,0,0,0,0,0,0,0],
    [1,0,0,0,0,0,0,0],
  ],
  'Q': [
    [0,1,1,1,1,0,0,0],
    [1,0,0,0,0,1,0,0],
    [1,0,0,0,0,1,0,0],
    [1,0,0,0,0,1,0,0],
    [1,0,0,0,0,1,0,0],
    [1,0,0,1,0,1,0,0],
    [1,0,0,0,1,0,0,0],
    [0,1,1,1,0,1,0,0],
  ],
  'R': [
    [1,1,1,1,1,0,0,0],
    [1,0,0,0,0,1,0,0],
    [1,0,0,0,0,1,0,0],
    [1,1,1,1,1,0,0,0],
    [1,0,0,1,0,0,0,0],
    [1,0,0,0,1,0,0,0],
    [1,0,0,0,0,1,0,0],
    [1,0,0,0,0,0,1,0],
  ],
  'S': [
    [0,1,1,1,1,1,0,0],
    [1,0,0,0,0,0,0,0],
    [1,0,0,0,0,0,0,0],
    [0,1,1,1,1,0,0,0],
    [0,0,0,0,0,1,0,0],
    [0,0,0,0,0,1,0,0],
    [0,0,0,0,0,1,0,0],
    [1,1,1,1,1,0,0,0],
  ],
  'T': [
    [1,1,1,1,1,1,1,0],
    [0,0,0,1,0,0,0,0],
    [0,0,0,1,0,0,0,0],
    [0,0,0,1,0,0,0,0],
    [0,0,0,1,0,0,0,0],
    [0,0,0,1,0,0,0,0],
    [0,0,0,1,0,0,0,0],
    [0,0,0,1,0,0,0,0],
  ],
  'U': [
    [1,0,0,0,0,0,1,0],
    [1,0,0,0,0,0,1,0],
    [1,0,0,0,0,0,1,0],
    [1,0,0,0,0,0,1,0],
    [1,0,0,0,0,0,1,0],
    [1,0,0,0,0,0,1,0],
    [1,0,0,0,0,0,1,0],
    [0,1,1,1,1,1,0,0],
  ],
  'V': [
    [1,0,0,0,0,0,1,0],
    [1,0,0,0,0,0,1,0],
    [1,0,0,0,0,0,1,0],
    [0,1,0,0,0,1,0,0],
    [0,1,0,0,0,1,0,0],
    [0,0,1,0,1,0,0,0],
    [0,0,1,0,1,0,0,0],
    [0,0,0,1,0,0,0,0],
  ],
  'W': [
    [1,0,0,0,0,0,1,0],
    [1,0,0,0,0,0,1,0],
    [1,0,0,0,0,0,1,0],
    [1,0,0,0,0,0,1,0],
    [1,0,0,1,0,0,1,0],
    [1,0,1,0,1,0,1,0],
    [1,1,0,0,0,1,1,0],
    [1,0,0,0,0,0,1,0],
  ],
  'X': [
    [1,0,0,0,0,0,1,0],
    [0,1,0,0,0,1,0,0],
    [0,0,1,0,1,0,0,0],
    [0,0,0,1,0,0,0,0],
    [0,0,0,1,0,0,0,0],
    [0,0,1,0,1,0,0,0],
    [0,1,0,0,0,1,0,0],
    [1,0,0,0,0,0,1,0],
  ],
  'Y': [
    [1,0,0,0,0,0,1,0],
    [0,1,0,0,0,1,0,0],
    [0,0,1,0,1,0,0,0],
    [0,0,0,1,0,0,0,0],
    [0,0,0,1,0,0,0,0],
    [0,0,0,1,0,0,0,0],
    [0,0,0,1,0,0,0,0],
    [0,0,0,1,0,0,0,0],
  ],
  'Z': [
    [1,1,1,1,1,1,1,0],
    [0,0,0,0,0,1,0,0],
    [0,0,0,0,1,0,0,0],
    [0,0,0,1,0,0,0,0],
    [0,0,1,0,0,0,0,0],
    [0,1,0,0,0,0,0,0],
    [1,0,0,0,0,0,0,0],
    [1,1,1,1,1,1,1,0],
  ],
  // Numbers
  '0': [
    [0,1,1,1,1,0,0,0],
    [1,0,0,0,0,1,0,0],
    [1,0,0,0,1,1,0,0],
    [1,0,0,1,0,1,0,0],
    [1,0,1,0,0,1,0,0],
    [1,1,0,0,0,1,0,0],
    [1,0,0,0,0,1,0,0],
    [0,1,1,1,1,0,0,0],
  ],
  '1': [
    [0,0,1,0,0,0,0,0],
    [0,1,1,0,0,0,0,0],
    [0,0,1,0,0,0,0,0],
    [0,0,1,0,0,0,0,0],
    [0,0,1,0,0,0,0,0],
    [0,0,1,0,0,0,0,0],
    [0,0,1,0,0,0,0,0],
    [0,1,1,1,0,0,0,0],
  ],
  '2': [
    [0,1,1,1,1,0,0,0],
    [1,0,0,0,0,1,0,0],
    [0,0,0,0,0,1,0,0],
    [0,0,0,0,1,0,0,0],
    [0,0,0,1,0,0,0,0],
    [0,0,1,0,0,0,0,0],
    [0,1,0,0,0,0,0,0],
    [1,1,1,1,1,1,0,0],
  ],
  '3': [
    [0,1,1,1,1,0,0,0],
    [1,0,0,0,0,1,0,0],
    [0,0,0,0,0,1,0,0],
    [0,0,1,1,1,0,0,0],
    [0,0,0,0,0,1,0,0],
    [0,0,0,0,0,1,0,0],
    [1,0,0,0,0,1,0,0],
    [0,1,1,1,1,0,0,0],
  ],
  '4': [
    [0,0,0,0,1,0,0,0],
    [0,0,0,1,1,0,0,0],
    [0,0,1,0,1,0,0,0],
    [0,1,0,0,1,0,0,0],
    [1,0,0,0,1,0,0,0],
    [1,1,1,1,1,1,0,0],
    [0,0,0,0,1,0,0,0],
    [0,0,0,0,1,0,0,0],
  ],
  '5': [
    [1,1,1,1,1,1,0,0],
    [1,0,0,0,0,0,0,0],
    [1,0,0,0,0,0,0,0],
    [1,1,1,1,1,0,0,0],
    [0,0,0,0,0,1,0,0],
    [0,0,0,0,0,1,0,0],
    [1,0,0,0,0,1,0,0],
    [0,1,1,1,1,0,0,0],
  ],
  '6': [
    [0,1,1,1,1,0,0,0],
    [1,0,0,0,0,0,0,0],
    [1,0,0,0,0,0,0,0],
    [1,1,1,1,1,0,0,0],
    [1,0,0,0,0,1,0,0],
    [1,0,0,0,0,1,0,0],
    [1,0,0,0,0,1,0,0],
    [0,1,1,1,1,0,0,0],
  ],
  '7': [
    [1,1,1,1,1,1,0,0],
    [0,0,0,0,0,1,0,0],
    [0,0,0,0,1,0,0,0],
    [0,0,0,1,0,0,0,0],
    [0,0,1,0,0,0,0,0],
    [0,0,1,0,0,0,0,0],
    [0,0,1,0,0,0,0,0],
    [0,0,1,0,0,0,0,0],
  ],
  '8': [
    [0,1,1,1,1,0,0,0],
    [1,0,0,0,0,1,0,0],
    [1,0,0,0,0,1,0,0],
    [0,1,1,1,1,0,0,0],
    [1,0,0,0,0,1,0,0],
    [1,0,0,0,0,1,0,0],
    [1,0,0,0,0,1,0,0],
    [0,1,1,1,1,0,0,0],
  ],
  '9': [
    [0,1,1,1,1,0,0,0],
    [1,0,0,0,0,1,0,0],
    [1,0,0,0,0,1,0,0],
    [0,1,1,1,1,1,0,0],
    [0,0,0,0,0,1,0,0],
    [0,0,0,0,0,1,0,0],
    [0,0,0,0,0,1,0,0],
    [0,1,1,1,1,0,0,0],
  ],
  // Symbols
  '+': [
    [0,0,0,0,0,0,0,0],
    [0,0,0,1,0,0,0,0],
    [0,0,0,1,0,0,0,0],
    [0,1,1,1,1,1,0,0],
    [0,0,0,1,0,0,0,0],
    [0,0,0,1,0,0,0,0],
    [0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
  ],
  '-': [
    [0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
    [0,1,1,1,1,1,0,0],
    [0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
  ],
  ',': [
    [0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
    [0,0,1,0,0,0,0,0],
    [0,0,1,0,0,0,0,0],
    [0,1,0,0,0,0,0,0],
  ],
  '.': [
    [0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
    [0,1,1,0,0,0,0,0],
    [0,1,1,0,0,0,0,0],
  ],
  '%': [
    [1,1,0,0,0,1,0,0],
    [1,1,0,0,1,0,0,0],
    [0,0,0,0,1,0,0,0],
    [0,0,0,1,0,0,0,0],
    [0,0,1,0,0,0,0,0],
    [0,1,0,0,0,0,0,0],
    [0,1,0,0,1,1,0,0],
    [1,0,0,0,1,1,0,0],
  ],
  '$': [
    [0,0,1,0,0,0,0,0],
    [0,1,1,1,1,0,0,0],
    [1,0,1,0,0,0,0,0],
    [0,1,1,1,0,0,0,0],
    [0,0,1,0,1,0,0,0],
    [0,0,1,0,1,0,0,0],
    [1,1,1,1,0,0,0,0],
    [0,0,1,0,0,0,0,0],
  ],
  '/': [
    [0,0,0,0,0,1,0,0],
    [0,0,0,0,1,0,0,0],
    [0,0,0,0,1,0,0,0],
    [0,0,0,1,0,0,0,0],
    [0,0,1,0,0,0,0,0],
    [0,0,1,0,0,0,0,0],
    [0,1,0,0,0,0,0,0],
    [0,1,0,0,0,0,0,0],
  ],
  '(': [
    [0,0,1,0,0,0,0,0],
    [0,1,0,0,0,0,0,0],
    [1,0,0,0,0,0,0,0],
    [1,0,0,0,0,0,0,0],
    [1,0,0,0,0,0,0,0],
    [1,0,0,0,0,0,0,0],
    [0,1,0,0,0,0,0,0],
    [0,0,1,0,0,0,0,0],
  ],
  ')': [
    [1,0,0,0,0,0,0,0],
    [0,1,0,0,0,0,0,0],
    [0,0,1,0,0,0,0,0],
    [0,0,1,0,0,0,0,0],
    [0,0,1,0,0,0,0,0],
    [0,0,1,0,0,0,0,0],
    [0,1,0,0,0,0,0,0],
    [1,0,0,0,0,0,0,0],
  ],
  ' ': [
    [0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
  ],
  ':': [
    [0,0,0,0,0,0,0,0],
    [0,1,1,0,0,0,0,0],
    [0,1,1,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
    [0,1,1,0,0,0,0,0],
    [0,1,1,0,0,0,0,0],
    [0,0,0,0,0,0,0,0],
  ],
};

// Add lowercase letters (simplified - mapping to uppercase for now)
const lowercaseLetters = 'abcdefghijklmnopqrstuvwxyz';
lowercaseLetters.split('').forEach(char => {
  BLOOMBERG_CHAR_PATTERNS[char] = BLOOMBERG_CHAR_PATTERNS[char.toUpperCase()] || [];
});

// Bloomberg Terminal Color Definitions
export const BLOOMBERG_COLORS = {
  background: { r: 0, g: 0, b: 0 },          // #000000
  backgroundAlt: { r: 26, g: 26, b: 46 },    // #1a1a2e
  headerBg: { r: 255, g: 140, b: 0 },         // #ff8c00
  headerBgAlt: { r: 255, g: 165, b: 0 },      // #ffa500
  textWhite: { r: 255, g: 255, b: 255 },     // #ffffff
  textGreen: { r: 0, g: 255, b: 0 },          // #00ff00
  textGreenAlt: { r: 50, g: 205, b: 50 },    // #32cd32
  textRed: { r: 255, g: 0, b: 0 },            // #ff0000
  textRedAlt: { r: 220, g: 20, b: 60 },      // #dc143c
  textYellow: { r: 255, g: 255, b: 0 },      // #ffff00
  gridLine: { r: 51, g: 51, b: 51 },          // #333333
};

// Bloomberg Terminal Layout Constants
export const BLOOMBERG_LAYOUT = {
  charWidth: 8,
  charHeight: 12,
  lineHeight: 16,
  headerHeight: 20,
  columns: [
    { name: 'NO', startX: 0, width: 35 },
    { name: 'Security', startX: 35, width: 180 },
    { name: 'Ticker', startX: 215, width: 90 },
    { name: 'Source', startX: 305, width: 70 },
    { name: 'Position', startX: 375, width: 90 },
    { name: 'Pos Chg', startX: 465, width: 80 },
    { name: '% Out', startX: 545, width: 55 },
    { name: 'Curr MV', startX: 600, width: 100 },
    { name: 'Filing Date', startX: 700, width: 80 }
  ]
};

// Helper Functions
export const getCharPattern = (char: string): number[][] | null => {
  return BLOOMBERG_CHAR_PATTERNS[char] || null;
};

export const comparePatterns = (pattern1: number[][], pattern2: number[][]): number => {
  if (!pattern1 || !pattern2) return 0;
  if (pattern1.length !== pattern2.length) return 0;
  
  let matches = 0;
  let total = 0;
  
  for (let y = 0; y < pattern1.length; y++) {
    for (let x = 0; x < pattern1[y].length; x++) {
      if (pattern2[y] && pattern2[y][x] !== undefined) {
        total++;
        if (pattern1[y][x] === pattern2[y][x]) {
          matches++;
        }
      }
    }
  }
  
  return total > 0 ? matches / total : 0;
};

export const isBackgroundColor = (r: number, g: number, b: number): boolean => {
  const threshold = 50;
  return (
    (Math.abs(r - BLOOMBERG_COLORS.background.r) < threshold &&
     Math.abs(g - BLOOMBERG_COLORS.background.g) < threshold &&
     Math.abs(b - BLOOMBERG_COLORS.background.b) < threshold) ||
    (Math.abs(r - BLOOMBERG_COLORS.backgroundAlt.r) < threshold &&
     Math.abs(g - BLOOMBERG_COLORS.backgroundAlt.g) < threshold &&
     Math.abs(b - BLOOMBERG_COLORS.backgroundAlt.b) < threshold)
  );
};

export const isHeaderColor = (r: number, g: number, b: number): boolean => {
  const threshold = 60;
  return (
    (Math.abs(r - BLOOMBERG_COLORS.headerBg.r) < threshold &&
     Math.abs(g - BLOOMBERG_COLORS.headerBg.g) < threshold &&
     Math.abs(b - BLOOMBERG_COLORS.headerBg.b) < threshold) ||
    (Math.abs(r - BLOOMBERG_COLORS.headerBgAlt.r) < threshold &&
     Math.abs(g - BLOOMBERG_COLORS.headerBgAlt.g) < threshold &&
     Math.abs(b - BLOOMBERG_COLORS.headerBgAlt.b) < threshold)
  );
};

export const isPositiveColor = (r: number, g: number, b: number): boolean => {
  const threshold = 80;
  return g > 150 && g > r && g > b;
};

export const isNegativeColor = (r: number, g: number, b: number): boolean => {
  const threshold = 80;
  return r > 150 && r > g && r > b;
};

export const isWhiteText = (r: number, g: number, b: number): boolean => {
  return r > 200 && g > 200 && b > 200;
};

export const detectTextColor = (r: number, g: number, b: number): 'white' | 'green' | 'red' | 'yellow' => {
  if (isPositiveColor(r, g, b)) return 'green';
  if (isNegativeColor(r, g, b)) return 'red';
  if (r > 200 && g > 200 && b < 100) return 'yellow';
  return 'white';
};
